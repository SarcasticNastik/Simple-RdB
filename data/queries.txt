LOAD EMPLOYEE
FILTERED_EMP_Q1 <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn,Salary FROM FILTERED_EMP_Q1
EXPORT Q1

EMP_EMP_Q2 <- CROSS EMPLOYEE EMPLOYEE
EMP_SUPEMP_Q2 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM EMP_EMP_Q2
EMP_SUPEMP_SAMEBD_Q2 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM EMP_SUPEMP_Q2
Q2 <- PROJECT EMPLOYEE1_Ssn,EMPLOYEE1_Super_ssn,EMPLOYEE1_Bdate FROM EMP_SUPEMP_SAMEBD_Q2
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE1_Super_ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2
EXPORT Q2

LOAD WORKS_ON
WORKS_ON_EMP_Q3 <- CROSS WORKS_ON EMPLOYEE
PROJECT_EMP_Q3 <- SELECT Essn == Ssn FROM WORKS_ON_EMP_Q3
PROJECT_SEX_Q3 <- PROJECT Pno,Sex FROM PROJECT_EMP_Q3
PROJECT_SEX_CROSS_Q3 <- CROSS PROJECT_SEX_Q3 PROJECT_SEX_Q3
PROJECT_DISTINCT_SEX_Q3 <- SELECT PROJECT_SEX_Q31_Sex != PROJECT_SEX_Q32_Sex FROM PROJECT_SEX_CROSS_Q3
PROJECT_DISTINCT_Q3 <- SELECT PROJECT_SEX_Q31_Pno == PROJECT_SEX_Q32_Pno FROM PROJECT_DISTINCT_SEX_Q3
Q3 <- PROJECT PROJECT_SEX_Q31_Pno FROM PROJECT_DISTINCT_Q3
RENAME PROJECT_SEX_Q31_Pno TO Pno FROM Q3
EXPORT Q3

PROJ_EMP <- CROSS EMPLOYEE WORKS_ON
EMP_IN_PROJ <- SELECT Ssn == Essn FROM PROJ_EMP
EMP_EMP_PROJ <- CROSS EMP_IN_PROJ EMP_IN_PROJ
EMP_SUP_PROJ <- SELECT EMP_IN_PROJ1_Super_ssn == EMP_IN_PROJ2_Ssn FROM EMP_EMP_PROJ
EMP_SUP_SAME_PROJ <- SELECT EMP_IN_PROJ1_Pno == EMP_IN_PROJ2_Pno FROM EMP_SUP_PROJ
ALMOST_ANS <- PROJECT EMP_IN_PROJ1_Ssn,EMP_IN_PROJ2_Ssn,EMP_IN_PROJ1_Pno FROM EMP_SUP_SAME_PROJ
RENAME EMP_IN_PROJ1_Ssn TO Ssn FROM ALMOST_ANS
RENAME EMP_IN_PROJ2_Ssn TO Super_ssn FROM ALMOST_ANS
RENAME EMP_IN_PROJ1_Pno TO Pno FROM ALMOST_ANS
Q4 <- PROJECT Ssn,Super_ssn,Pno FROM ALMOST_ANS
EXPORT Q4

LOAD PROJECT
PROJ2 <- SELECT Dnum != 2 FROM PROJECT
PROJ3 <- SELECT Dnum != 3 FROM PROJ2
Q5 <- SELECT Dnum != 4 FROM PROJ3
EXPORT Q5

QUIT
